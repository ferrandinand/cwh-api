package dto

type VulnerabilityResponse struct {
	Id              int                    `json:"id"`
	ProjectWithEnv  string                 `json:"project_env"`
	Project         string                 `json:"project"`
	Cluster         string                 `json:"cluster"`
	AppName         string                 `json:"application"`
	Installation    int                    `json:"installation"`
	Registry        string                 `json:"registry"`
	ReportedOn      string                 `json:"reported_on"`
	Image           string                 `json:"image"`
	Tenant          string                 `json:"tenant"`
	Critical        int                    `json:"critical"`
	High            int                    `json:"high"`
	Low             int                    `json:"low"`
	Medium          int                    `json:"medium"`
	None            int                    `json:"none"`
	Unknown         int                    `json:"unknown"`
	Vulnerabilities map[string]interface{} `json:"vulnerabilities"`
}

type VulnerabilityResponseList struct {
	Items      []VulnerabilityResponse `json:"items"`
	NextPageID int                     `json:"next_page_id,omitempty" example:"10"`
	PrevPageID int                     `json:"prev_page_id,omitempty" example:"10"`
}

type NewVulnerabilityReport struct {
	Project         string                      `yaml:"project"`
	Cluster         string                      `yaml:"cluster"`
	Installation    int                         `yaml:"installation"`
	Tenant          string                      `yaml:"tenant"`
	Vulnerabilities map[string]AppVulnerability `yaml:"vulnerabilities"`
}

type AppVulnerability struct {
	Image           string                   `yaml:"image"`
	Registry        string                   `yaml:"registry"`
	Summary         AppVulnerabilitySummary  `yaml:"summary"`
	Vulnerabilities []map[string]interface{} `yaml:"vulnerabilities"`
}

type AppVulnerabilitySummary struct {
	CriticalCount int `yaml:"criticalCount"`
	HighCount     int `yaml:"highCount"`
	LowCount      int `yaml:"lowCount"`
	MediumCount   int `yaml:"mediumCount"`
	NoneCount     int `yaml:"noneCount"`
	UnknownCount  int `yaml:"unknownCount"`
}
